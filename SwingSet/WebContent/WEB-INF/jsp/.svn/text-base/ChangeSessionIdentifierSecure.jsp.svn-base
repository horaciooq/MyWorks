<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@include file="header.jsp" %>

<h2 align="center">Exercise: Change Session Identifier</h2>

<%
	ESAPI.httpUtilities().changeSessionIdentifier(ESAPI.httpUtilities().getCurrentRequest());

    String orig = (String)request.getSession().getAttribute( "cookie" );
	if ( orig == null ) {
		orig = request.getSession().getId();
		request.getSession().setAttribute("cookie",orig);
	}
%>

<p>Original Cookie (saved in session)</p>
<table align="center" border="1" width="60%"><tr><td align="center">
	<br>JSESSIONID=<%=orig %><br><br>
</td></tr></table>

<p>Current Cookie (generated by JavaScript in browser)</p>
<table align="center" border="1" width="60%"><tr><td align="center">
	<br><script>document.write(document.cookie)</script><br><br>
</td></tr></table>

<p>Click <a href="main?function=ChangeSessionIdentifier&secure">here</a> to refresh the page with a new session identifier.</p>

<%@include file="footer.jsp" %>
